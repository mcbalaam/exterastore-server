generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id             String   @id @default(uuid())
  username       String   @unique
  email          String
  title          String?
  timeoutDue     Int?
  profilePicture String
  isSupporter    Boolean
  passwordHash   String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  preferences    Json?
  status         String   @default("active")
}

model exteraPlugin {
  id             String          @id @default(uuid())
  name           String
  description    String?
  releases       pluginRelease[]
  forkOrigin     exteraPlugin?   @relation("PluginFork", fields: [forkOriginId], references: [id])
  forkOriginId   String?
  forkedPlugins  exteraPlugin[]  @relation("PluginFork")
  stars          String[]
  reactions      Json            @default("{}")
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  targetPlatform String[]
}

model pluginRelease {
  id           String       @id @default(uuid())
  releaseNotes String?
  file         String
  plugin       exteraPlugin @relation(fields: [pluginId], references: [id])
  pluginId     String
  reactions    Json         @default("{}")
  downloads    Int
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}
